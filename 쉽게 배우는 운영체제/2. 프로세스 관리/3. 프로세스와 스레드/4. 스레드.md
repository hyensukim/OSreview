# 스레드의 개념
## 정의
- 프로세스의 코드 안에 정의된 절차에 따라 CPU에게 작업을 요청하는 단위.
- CPU 스케줄러가 CPU에게 전달하는 작업의 단위.

## 작업의 크기
`처리(job) > 프로세스(task) > 스레드(operation) `

## 프로세스와 스레드의 차이
- 프로세스는 서로 간에 독립적이기 때문에 연결이 약하다.
- 프로세스 간에 데이터를 송수신할 때 IPC(Inter Process Communication)를 통해 통신이 이뤄진다.
- 스레드는 프로세스 내 자원을 공유하기 때문에 연결이 강하다.
- 변수, 파일 등의 자원을 공유하고 전역 변수나 함수 호출을 통해 통신을 하여 통신 비용이 상대적으로 적다.

## 스레드 관련 용어
- `멀티 스레드` : 프로세스 내 작업을 여러 스레드로 분할하여 작업 부담을 줄여주는 프로세스 운용 기법.
- `멀티 태스킹` : 운영체제가 CPU에 작업을 전달할 때 시간을 분할하여 전달하는 기법.
- `멀티 프로세싱` : 여러 개의 CPU로 여러 스레드를 동시에 처리하는 방식.
- `CPU의 멀티 스레드` : 하나의 CPU로 여러 스레드를 동시에 처리하는 방식.

- 멀티 태스킹은 멀티 프로그래밍, 시분할 시스템, 실시간 시스템을 통해 구현되었다.
    - 멀티 프로그래밍 : 프로세서가 하나의 프로세스를 처리 중에 다른 프로세스로 접근이 가능한 방식.
        - 작업 효율을 높이기 위한 방식.
    - 시분할 시스템 : 작업을 시간 단위로 잘게 나누어 동시에 작업 하는 것처럼 보이는 시스템.
    - 실시간 시스템 : 시분할 시스템의 단점을 보완하여, 중요 작업의 종료 시간을 보장하는 시스템.

# 멀티 스레드의 구조
- 기존에 여러 작업을 동시에 처리하기 위해 fork(), exec() 시스템 호출을 사용하였다.
- 멀티 태스킹도 기존의 방식으로 동시 작업을 수행하였다.
- 하지만, 이러한 방식은 메모리 내 자원의 중복으로 인해 메모리 낭비가 발생하게 된다.
- 멀티 스레드 방식은 프로세스 내부의 자원을 공유하여 사용하기 때문에 자원의 낭비 없이 효율적으로 작업이 가능하다.

# 멀티 스레드의 장단점
- 장점
    - 응답성 향상 : 단일 스레드에 비해 사용자 요청에 대한 응답이 빠르다.
    - 자원 공유 : 프로세스의 자원을 공유하여 사용하여 작업이 원활하다.
    - 효율성 향상 : 메모리를 효율적으로 관리한다.
    - 다중 CPU 지원 : 2개 이상의 CPU를 가진 컴퓨터에서 멀티 스레드 사용 시, CPU 사용률 향상 및 프로세스 처리 시간 단축이 가능하다.

# 멀티 스레드의 모델
- 스레드도 프로세스와 같이 커널 스레드와 사용자 스레드로 구분된다.
- 커널 스레드는 커널이 직접 생성하고 관리하는 스레드이고, 사용자 스레드는 라이브러리에 구현된 일반적인 스레드이다. 사용자가 커널 스레드를 사용하기 위해서는 시스템 호출을 거쳐야 한다.
- `사용자 스레드(1 to N 모델)`
    - 사용자 프로세스 내에 여러 개의 스레드가 존재하지만 커널의 스레드 하나와 연결되어 있기 때문에 ‘1 to N 모델’이라고 한다.
    - 커널이 멀티 스레드를 지원하지 않을 때 사용하는 방법으로 초기 스레드 시스템에서 사용되었다. 사용자 스레드 라이브러리는 커널이 지원하는 스케줄링이나 동기화 같은 기능을 대신 구현해준다. 
    - 사용자 스레드는 라이브러리에서 직접 스케줄링하고 작업에 필요한 정보를 처리하기 때문에 문맥 교환이 필요가 없어서 작업 속도가 빠르다.
    - 단점은 여러 개의 스레드가 하나의 커널 스레드와 연결되기 때문에 하나의 스레드의 입출력 작업으로 인해 대기 상태에 들어가면 커널 스레드가 멈춰 모든 스레드가 함께 대기한다.
    - 또 다른 단점은 한 프로세스의 타임 슬라이스를 여러 스레드가 공유하기 때문에 여러 개의 CPU를 동시에 사용할 수 없다는 것이다.
    - 또한 보안에 취약하다. 커널 레벨에서는 공유 변수를 보호하는 장치가 있으나 서비스를 커널이 아닌 라이브러리에서 구현해야 하기 때문이다.
- `커널 스레드(1 to 1 모델)`
    - 커널이 멀티 스레드를 지원하는 방식. 하나의 스레드가 하나의 커널 스레드와 연결되기 때문에 1 to 1 모델이라고 한다.
    - 커널 스레드의 장단점은 사용자 스레드와 정반대이다.
- `멀티레벨 스레드(M to N 모델)`
    - 사용자 스레드와 커널 스레드를 혼합한 방식.
    - 빠르게 움직여야 하는 스레드는 사용자 스레드로 작동하고, 안정적으로 움지여야 하는 스레드는 커널 스레드로 작동한다.