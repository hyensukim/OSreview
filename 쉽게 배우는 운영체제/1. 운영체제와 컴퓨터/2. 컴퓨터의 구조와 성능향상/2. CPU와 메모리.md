# 1. CPU의 구성과 동작
## CPU의 기본 구성
- CPU는 산술논리 연산장치, 제어장치, 레지스터로 구성되며, 이것들의 협업으로 작업을 처리한다.

### 산술논리 연산장치(ALU : Arithmetic and Logic Unit)
- CPU에서 데이터를 연산하는 장치.
- 사칙연산과 같은 산술 연산과 AND,OR,NOT 등과 같은 논리 연산을 수행.

### 제어장치
- CPU에서 작업을 지시하는 장치.

### 레지스터
- 작업에 필요한 데이터를 CPU 내부에 보관하는 곳.
- 레지스터는 계산을 위해 가져온 데이터를 저장하거나, 계산의 중간값을 임시로 보관하거나, 작업을 진행하기 위해 필요한 정보를 보관하는 등
  사용되는 곳에 따라 종류가 다양하다.

## CPU의 명령어 처리 과정
- 제어장치, 산술논리 연산장치, 레지스터들이 협업하여 작업을 처리한다.
    ```
    ※ 명령어 : 메모리에 저장된 데이터를 연산하여 다시 메모리에 저장하라.
    1. 제어장치는 메모리 주소에 있는 값을 레지스터로 옮기라는 명령을 내린다.
    2. 레지스터 값을 산술논리 연산장치에 보내서 연산하라는 명령을 내린다.
    3. 결과값을 레지스터에 임시 보관한다.
    4. 레지스터의 값을 메모리에 옮기라는 명령을 내린다.
    ```
- 처리과정
    - 그림 추가.

## 레지스터의 종류
- 일반 레지스터 : 사용자 프로그램에 의해 변경되는 레지스터(사용자 가시 레지스터)
    ```
    ○ 데이터 레지스터(DR, data register) : 메모리에서 가져온 데이터를 임시로 저장.

    ○ 주소 레지스터(AR, address register) : 데이터 또는 명령어가 저장된 메모리의 주소가 저장.
    ```
- 특수 레지스터 : 특별한 용도로 사용되며, 사용자가 임의로 변경할 수 없는 레지스터(사용자 불가시 레지스터)
    ```
    ○ 프로그램 카운터(PC, program counter) : 다음에 실행할 명령어의 주소(코드의 행번호)를 저장.

    ○ 명령어 레지스터(IR, instruction register) : 현재 실행 중인 명령어를 저장.

    ○ 메모리 주소 레지스터(MAR, memory address register) : 메모리에서 데이터를 가져오거나 메모리로 데이터를 보낼 때 주소를 지정하는데 사용. 명령어 처리 과정에서 필요한 메모리 주소를 이 레지스터에 넣으면 메모리 관리자가 인식하여 해당 메모리의 위치의 데이터를 가져오거나 저장한다.

    ○ 메모리 버퍼 레지스터(MBR, memory buffer register) : 메모리에서 가져온 데이터나 메모리로 옮겨갈 데이터를 임시로 저장한다. 메모리 주소 레지스터와 항상 함께 동작한다.

    ○ 프로그램 상태 레지스터(PSR, program status register) : 조건문의 조건식에 사용되는 연산 결과를 저장. 산술논리 연산장치와 연결되어 있다.

    ```

### 메모리로부터 데이터를 가져오는 과정
- 
    ```
    ① 프로그램 카운터에 다음 실행해야 하는 코드의 행번호가 저장되어 있다. 행번호가 제어장치에 전송되면, 해당 코드가 실행된다.
      그 다음으로 코드 내 명령어가 명령어 레지스터에 저장된다.
    ② 제어장치가 명령어 레지스터 안에 있는 명령어를 해석하여 메모리 주소로 부터 데이터를 가져오라는 제어신호를 보낸다.
    ③ 메모리 주소 레지스터에 메모리 주소가 저장된다. 메모리에 있는 데이터를 CPU로 옮기는 일은 '메모리 관리자'가 담당한다.
      메모리 관리자는 해당 주소에 저장되어 있는 데이터를 메모리 버퍼 레지스터에 저장한다.
      -> 데이터 레지스터는 CPU 영역이므로, 메모리 관리자가 접근할 수 없어 메모리 버퍼 레지스터에 값을 저장한다.
    ④ 제어장치는 메모리 버퍼 레지스터에 저장된 값을 데이터 레지스터로 옮긴다.
    ```

## 버스의 종류
- CPU와 메모리, 주변장치 간에 데이터를 주고 받을 경우 시스템 버스를 사용한다.
- 시스템 버스는 제어버스, 주소버스, 데이터버스로 나뉜다.
- 그림 추가.
    - 제어버스
        - 다음에 어떤 작업을 할지 지시하는 제어신호가 오고간다.
        - 제어버스는 CPU의 제어장치와 연결되어 있다.
        - 제어버스의 신호는 CPU, 메모리, 주변장치와 양방향으로 오고간다.
    - 주소버스
        - 메모리의 데이터를 읽거나 쓸 때 어느 위치에서 작업할 것인지 위치 정보가 오고간다.
        - 주소버스는 메모리 주소 레지터와 연결되어 있으며 단방향이다.
        - CPU에서 메모리나 주변장치롤 나가는 주소 정보만 있다.
    - 데이터버스
        - 데이터가 실려 목적지까지 이동할때 사용.
        - 데이터버스는 메모리 버퍼 레지스터와 연결되어 있으며 양방향이다.

## CPU 비트의 의미
- 버스의 대역폭 : 한번에 전달할 수 있는 데이터의 최대 크기.
- 버스의 대역폭은 CPU가 한번에 처리할 수 있는 데이터의 크기, 레지스터의 크기, 메모리에 한 번에 저장할 수 있는 데이터 크기와 같다.
- 워드 : CPU가 한번에 처리할 수 있는 데이터의 최대 크기.
    - 32bit CPU는 1워드가 32bit이고, 64bit CPU는 1워드가 64bit이다.

<br><br>

# 2. 메모리의 종류와 부팅
- 모든 프로그램은 메모리에 올라와야 실행이 가능하다.(폰노이만 구조)
- 메모리는 소자 하나의 크기가 1bit이고, 데이터를 표현하기 위해 바이트(8bit) 단위로 저장된다.
- 1B(바이트)씩 나눠진 공간에 0번부터 시작하는 주소가 있다.


## 메모리의 종류
### RAM(Random Access Memory)
- 휘발성 : 전력이 끊기면 데이터가 사라지는 메모리.
    - DRAM : 저장된 데이터가 일정 시간이 지나면 사라지므로 일정 시간마다 다시 재생하여 저장해줘야한다.
    - SRAM : 전력이 공급되는 동안에는 데이터를 보관할 수 있어 추가 재생이 필요 없다.
        - 속도는 빠르지만 가격이 비싸다.
        - 일반적으로 메인메모리용 - DRAM, 캐시메모리용- SRAM을 사용한다.
    - SDRAM : DRAM의 발전형태로 클록틱(펄스)이 발생할 때마다 데이터를 저장하는 동기 DRAM.
- 비휘발성 : 전력이 끊겨도 데이터를 보관할 수 있는 메모리.
    - 플래시 메모리 : 전력이 없어도 데이터를 보관하는 저장장치.
        - Ex) MP3 플레이어, 디지털카메라, USB 드라이버
        - 대신에, 플래시 메모리 각 소자는 최대 사용횟수가 제한되어 있어서 장기 사용 시 데이터 손상의 위험이 있다.
    - SSD : 하드디스크 대용으로 사용. 가격은 비싸지만 내구성이 좋고 데이터 접근 속도가 빠르다.

### ROM(Read Only Memory) 
- 전력이 끊겨도 데이터 보관이 가능하지만, 데이터 초기 저장 이후 변경이 불가능하다.
- 이러한 특징 때문에 현대에는 바이오스(BIOS, Basic Input Output System) 저장 용도로 사용된다.
- 종류
    - 마스크롬 : 데이터를 지우거나 쓸 수 없다.
    - PROM : 전용기기를 통해 데이터 저장이 초기 한번 가능하다.
    - EPROM : 데이터를 여러번 지우고 쓸 수 있지만 가격이 너무 비싸다.

## 메모리 보호
- 현대의 운영체제는 시분할 방식을 사용하여, 여러 프로그램이 동시에 실행되기 때문에 서로 다른 작업이 침범하게 될 경우,
  데이터 손상, 프로그램 파괴 및 심한 경우 운영체제에 문제를 발생시킬 수 도 있기 때문에 메모리 보호가 중요하다.
    - 바이러스 : 운영체제 또는 다른 프로그램 영역으로 침범하여 데이터 손상을 유도한 악성 소프트웨어.
- 운영체제도 소프트웨어 이므로 사용자 프로세스가 CPU를 차지하여 작업이 진행되면, 운영체제는 작업이 중단된다.
- 메모리 보호 방법
    - 운영체제 및 CPU가 협력하여 메모리 보호를 하기 위한 정책이 마련되어 있다.
    - 이는 CPU가 현재 진행중인 작업의 메모리 시작 주소를 `경계 레지스터`에 저장한 뒤 작업한다.
    - 그 다음 현재 진행중인 작업이 차지하는 메모리 크기에 해당하는 주소를 `한계 레지스터`에 저장한다.
    - 사용자 작업이 진행되는 동안에 이 두 레지스터의 주소 범위를 벗어나지 않는지 하드웨어 측면에서 점검하여 메모리를 보호한다.
    - 두 레지스터의 값을 벗어난 경우, 메모리 오류 및 관련 신호인 인터럽트가 발생한다.
    - 인터럽트 발생 시, 모든 작업 중단 및 CPU에서 운영체제를 실행시켜 문제를 처리한다.
    - 운영체제가 실행한 뒤 값을 벗어난 작업(프로세스)을 강제 종료한다.

## 부팅
- 컴퓨터 켰을 때 운영체제를 메모리에 올리는 과정.
- 부팅과정
    ```
     ROM(바이오스) → 하드웨어 점검
                        ↓
                  → 메모리에 부트스트랩 코드 실행. ← 마스터 부트 레코드(부트스트랩 코드 저장)
                        ↓
                    부트스트랩 코드가
                    운영체제 프로세스 실행 ← 운영체제
    ```
- 운영체제 저장위치 변화
    - 초기 : 카세트테이프
    - DOS : 플로피디스크
    - 현대 : 하드디스크 - 운영체제 & ROM - 바이오스